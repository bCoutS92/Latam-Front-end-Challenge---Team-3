// 2nd tentative Scroll using mouse/keyboard - userScroll becomes true, page load is false
var userScroll = false;     

function mouseEvent(e) { 
    userScroll = true; 
} 


  // we will add this content, replace for anything you want to add
 var more = '[WHEN SCROLLED CONTENT HERE] Integer volutpat massa magna, ac pharetra lorem pretium eget. Suspendisse porta dapibus mauris, sed porta lectus dictum ut. Nam fermentum semper euismod. Suspendisse semper felis justo, non molestie eros feugiat eget. Donec venenatis ultricies tortor, ut suscipit arcu. Maecenas mollis at erat at pulvinar. Aenean nec lobortis erat. Sed quis nunc mauris. Pellentesque viverra vel nunc quis pharetra. Proin id tempus eros. Phasellus in erat varius sem luctus scelerisque et sed purus. Ut tempor hendrerit rutrum. Praesent gravida vel libero sit amet eleifend. Quisque justo ligula, euismod eu maximus vel, cursus gravida sem. Fusce at mi ut enim auctor fermentum. Vivamus libero metus, sagittis quis urna at, imperdiet blandit velit. Nunc auctor feugiat felis nec consectetur. Quisque viverra quis enim sed eleifend. Integer dictum nisi non dignissim pulvinar. Quisque laoreet massa in nulla molestie tristique. Nullam at malesuada metus, vitae interdum elit. Nam pretium turpis a congue euismod. In at erat quis nisi ultrices fringilla. Aliquam eget dui quis felis volutpat aliquam. Donec semper arcu eu dui cursus mollis. Nunc at felis elit. Fusce a ultricies leo, eget euismod massa. Morbi varius, libero quis semper rutrum, risus massa porttitor sapien, non congue orci risus eu nulla. Proin non ornare metus. Vivamus a dapibus velit. Nulla eu sem massa. Vivamus eleifend dui eget eleifend feugiat. Fusce porttitor elit ac mi sollicitudin, at sodales diam egestas. In ut eros dignissim, consequat erat ut, blandit dui. Morbi ut nulla commodo, placerat nisi non, mollis tortor. Cras convallis tincidunt diam, id fermentum lacus maximus scelerisque. Nulla consectetur vulputate nunc vel vehicula. Suspendisse cursus vehicula arcu, vel egestas urna mattis mattis. Cras quis erat massa. Praesent accumsan ac risus et luctus. Integer quis ultrices leo. Praesent vel lacus in nisi lacinia tincidunt. In gravida, tortor lobortis lobortis tincidunt, enim urna tempor libero, fringilla tincidunt ligula ligula nec nunc. Phasellus mollis, lectus quis consectetur posuere, ex arcu fermentum quam, a vestibulum urna libero ut turpis. Praesent cursus tristique neque at elementum. Proin metus diam, commodo sit amet ante sed, faucibus interdum ligula. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Sed eget pretium est. Ut tincidunt metus at volutpat feugiat. Maecenas in ex vitae neque cursus facilisis. Quisque eleifend imperdiet urna volutpat pretium. Quisque suscipit blandit nisl nec sagittis. Etiam auctor, dui vel convallis gravida, arcu nisi fermentum purus, at sagittis quam dolor vel mi. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sollicitudin augue in lorem pulvinar, sit amet porttitor mi dignissim. Aliquam erat volutpat. Mauris aliquam quis est at interdum. Praesent vestibulum orci magna, eget eleifend mauris tincidunt id. Nulla varius dui arcu, sit amet rhoncus dolor iaculis sit amet. Curabitur eu ipsum leo. Quisque nec suscipit nibh. Fusce rutrum ipsum sed elit luctus semper. Fusce faucibus lacinia lacus, at eleifend lectus gravida porttitor. Morbi a nisl ultricies, porttitor libero sed, vestibulum lorem. Aenean consequat luctus quam id feugiat. Donec pretium erat in dui ultricies, et tempor sem auctor. Donec quis lacus mollis, dignissim odio sed, scelerisque mauris. Quisque ultricies rutrum nunc ut efficitur. Nunc accumsan nunc non faucibus faucibus. Nullam mauris nunc, pellentesque non ornare id, scelerisque ac ex. Maecenas eu tempor massa. Vivamus hendrerit nibh magna, ut commodo ex finibus vel. Nunc ut justo luctus, tempus augue et, tristique ex. Donec posuere mauris sit amet lorem sagittis scelerisque. Suspendisse semper bibendum est sit amet ultrices. Nulla nec interdum mi. Quisque nec risus ligula. Donec finibus sem vitae sodales euismod. Curabitur turpis diam, aliquam sit amet laoreet vitae, rhoncus ac nulla. Vivamus interdum dignissim metus, sed pulvinar urna ultricies vel. Quisque eleifend laoreet diam, non placerat augue dignissim ut. Suspendisse volutpat venenatis libero, non maximus sem. Fusce vel ante non erat dignissim gravida vitae quis diam. Mauris sodales, odio eu hendrerit tempus, arcu ex euismod arcu, at blandit neque lectus non eros. Pellentesque condimentum turpis a tellus dapibus fermentum. Vestibulum rhoncus laoreet lorem, vel hendrerit lectus ultricies ut. Praesent luctus justo metus, non porttitor ante efficitur vel. Fusce hendrerit ornare quam. Duis non facilisis leo, vel tristique nunc. Duis aliquam et magna ac ultrices. Donec ut auctor lacus. Morbi metus mauris, ullamcorper sed odio vel, euismod tincidunt urna. Praesent aliquet augue elit, id efficitur dolor tempor id. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nam feugiat posuere est, vel auctor tellus commodo ac. Quisque eget felis est. Mauris facilisis ultricies risus nec convallis. Curabitur efficitur luctus eros ac accumsan. Integer porta risus in arcu tincidunt, nec pulvinar ligula scelerisque. Mauris vulputate sapien mi, eget dictum arcu tempor tincidunt. Integer ac convallis odio. Phasellus tempus mauris non felis auctor, ut molestie turpis rhoncus. Cras in accumsan orci, sit amet ultrices augue. Nunc sed augue non dolor interdum bibendum. In orci risus, porta vestibulum nulla sed, hendrerit aliquet nunc. Aenean suscipit, est sit amet ornare luctus, lacus leo consequat ipsum, id fringilla massa dolor vel magna. Donec ut magna eget sapien maximus viverra. Duis vitae pretium felis, eget porttitor est. Morbi aliquam, mauris semper tempus consectetur, purus enim varius turpis, nec blandit metus dui et risus. Integer lectus massa, eleifend ac laoreet aliquet, suscipit eget leo. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vivamus at felis tincidunt, vehicula justo a, mattis nunc. Suspendisse facilisis, diam vitae lobortis porta, ipsum diam malesuada ligula, non consectetur erat tellus eget nisi. Proin pulvinar at nunc nec consectetur. Aenean in fermentum elit. Nulla gravida pharetra augue maximus tristique.';

  var body = document.getElementsByTagName("BODY") [0];
  var tag_content = document.getElementById("tag_content");
  tag_content.innerHTML = more;

  // cross browser addEvent, today you can safely use just addEventListener
  function addEvent(obj,ev,fn) {
    if(obj.addEventListener) obj.addEventListener(ev,fn,false);
    else if(obj.attachEvent) obj.attachEvent("on"+ev,fn);    
  }

  // this is the scroll event handler
  function scroller() {

    // add more contents if user scrolled down enough
   if(body.scrollTop+body.offsetHeight+100>tag_content.offsetHeight) {
     tag_content.innerHTML+= more;
     tag_content = [0];
   }
  console.log('scroll worked fine! See in the end of the page: [WHEN SCROLLED CONTENT HERE]');

  }

   //When the scroll is the maximum, the function must add another block id = "row_new" adding a number in each id within the block for example: id = "row_new_1"- All blocks id = "new_art_ads_X" must show advertising!
  var x = document.getElementById("row_new_1");
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }

  // hook the scroll handler to scroll event
  addEvent("scroll",scroller);


//prebid code
            var PREBID_TIMEOUT = 3000;
            var FAILSAFE_TIMEOUT = 6000;

            var googletag = googletag || {};
            googletag.cmd = googletag.cmd || [];

            var pbjs = pbjs || {};
            pbjs.que = pbjs.que || [];

            function initAdserver() {
                if (pbjs.initAdserverSet) return;

                googletag.cmd.push(function() {
                    pbjs.que.push(function() {
                        pbjs.setTargetingForGPTAsync();
                        googletag.pubads().refresh();
                    });
                });

                pbjs.initAdserverSet = true;
            }

            pbjs.que.push(function() {
            var adUnits = [{
                code: '/19968336/prebid_multiformat_test',
                mediaTypes: {
                        banner: {
                            sizes: [[300, 250]]
                        },
                        native: {
                            title: {
                                required: true
                            },
                            image: {
                                required: true
                            },
                            sponsoredBy: {
                                required: true
                            }
                        }
                    },
                bids: [{
                    bidder: 'appnexus',
                    params: {
                        placementId: 13232392
                    }
                }]
            },
            {
                code: '/19968336/header-bid-tag-0',
                mediaTypes: {
                        banner: {
                            sizes: [[300, 250]]
                        },
                        native: {
                            title: {
                                required: true
                            },
                            image: {
                                required: true
                            },
                            sponsoredBy: {
                                required: true
                            }
                        }
                    },
                bids: [{
                    bidder: 'appnexus',
                    params: {
                        placementId: 13232392
                    }
                }]
            }];

                pbjs.setConfig({
                    debug: true,
                    cache: {
                        url: false
                    },
                });

                pbjs.addAdUnits(adUnits);
                pbjs.requestBids({
                		timeout: PREBID_TIMEOUT,
                    bidsBackHandler: function(bidResponses) {
                        initAdserver();
                    }
                });
            });
            
            // in case PBJS doesn't load
            setTimeout(initAdserver, FAILSAFE_TIMEOUT);

            var slot1;
            googletag.cmd.push(function() {
                slot1 = googletag.defineSlot('/19968336/prebid_multiformat_test', [[300, 250],[300,600]], 'div-1')
                	.setTargeting('test', 'lazyload', "infinitescroll")
                    .addService(googletag.pubads());
                googletag.pubads().disableInitialLoad();
                googletag.pubads().enableSingleRequest();
                googletag.enableServices();
                googletag.pubads().enableLazyLoad();

                    // Register event handlers to observe lazy loading behavior.
                    googletag.pubads().addEventListener('slotRequested', function(event) {
                      console.log(event.slot.getSlotElementId(), 'Slot fetched');
                    });

                    googletag.pubads().addEventListener('slotOnload', function(event) {
                      console.log(event.slot.getSlotElementId(), 'Slot rendered');
                    });
                 googletag.enableServices();

            });
            
                function refreshBid() {
                pbjs.que.push(function() {
                    pbjs.requestBids({
                        timeout: PREBID_TIMEOUT,
                        adUnitCodes: ['/19968336/prebid_multiformat_test'],
                        bidsBackHandler: function() {
                            pbjs.setTargetingForGPTAsync(['/19968336/prebid_multiformat_test']);
                            googletag.pubads().refresh([slot1]);
                        }
                    });
                });
            }

            
            var slot2;
            googletag.cmd.push(function() {
                slot2 = googletag.defineSlot('/19968336/header-bid-tag-0', [[300, 250],[300,600]], 'div-2')
                    .setTargeting('test', 'lazyload', "infinitescroll")
                	.addService(googletag.pubads());
                googletag.pubads().disableInitialLoad();
                googletag.pubads().enableSingleRequest();
                googletag.enableServices();
                googletag.pubads().enableLazyLoad();

                    // Register event handlers to observe lazy loading behavior.
                    googletag.pubads().addEventListener('slotRequested', function(event) {
                      console.log(event.slot.getSlotElementId(), 'Slot fetched');
                    });

                    googletag.pubads().addEventListener('slotOnload', function(event) {
                      console.log(event.slot.getSlotElementId(), 'Slot rendered');
                    });
                 googletag.enableServices();
            });

            function refreshBid_1() {
                pbjs.que.push(function() {
                    pbjs.requestBids({
                        timeout: PREBID_TIMEOUT,
                        adUnitCodes: ['/19968336/header-bid-tag-0'],
                        bidsBackHandler: function() {
                            pbjs.setTargetingForGPTAsync(['/19968336/header-bid-tag-0']);
                            googletag.pubads().refresh([slot2]);
                        }
                    });
                });
            }

//If the user remains viewing a space for more than 10 seconds, only the space that is being viewed must be refreshed.
window.setInterval(refreshBid, 10*1000);
window.setInterval(refreshBid_1, 10*1000);
